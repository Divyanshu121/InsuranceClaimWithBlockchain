<!DOCTYPE html>
<html>
  <head>
    <title> Insurance DApp</title>
    
    <link rel="stylesheet"  href="style.css">

    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="text/javascript"></script>
    <script>
      const contractABI = [{
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "userId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "address",
          "name": "userAddress",
          "type": "address"
        }
      ],
      "name": "UserRegistered",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "lastUserId",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "name": "users",
      "outputs": [
        {
          "internalType": "address",
          "name": "userAddress",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "userId",
          "type": "uint256"
        },
        {
          "internalType": "string",
          "name": "name",
          "type": "string"
        },
        {
          "internalType": "string",
          "name": "email",
          "type": "string"
        },
        {
          "internalType": "string",
          "name": "password",
          "type": "string"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "string",
          "name": "_name",
          "type": "string"
        },
        {
          "internalType": "string",
          "name": "_email",
          "type": "string"
        },
        {
          "internalType": "string",
          "name": "_password",
          "type": "string"
        }
      ],
      "name": "registerUser",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }];
    const contractAddress="0x944dA3845175BF48f34D788024927D6d24ed0f90";
   function register(){
        var name = document.forms["myForm"]["name"].value;
        var email = document.forms["myForm"]["email"].value;
        var pass = document.forms["myForm"]["password"].value;
        console.log(name);
        const provider=new ethers.providers.Web3Provider(window.ethereum);
        const signer=provider.getSigner();
        let contract = new ethers.Contract(contractAddress, contractABI, signer);
        console.log(contract);
        let call=contract.registerUser(name,email,pass);
        // var name=document.getElementById("name").value;
        // var email=document.getElementById("email").value;
        // var password=document.getElementById("password").value;
        return 1;
      }
    </script>
    
  </head>
  <body>
    <span>
    <img src="insurance.jpg" alt="Image description">
  </div>
    <h1><center>ChainThat</center></h1>
    <h2>User Registration</h2>
    <form name ="myForm" id="registerUserForm" onsubmit="return register()">
      <div style="width: 10%;">
      <label for="name">Name:</label>
      <input type="text" id="name" placeholder="name" required><br><br>
      </div>
      <div style="width: 20%;">
      <label for="email">Email:</label>
      <input type="email" id="email" placeholder="email" required><br><br>
      </div>
      <div style="width: 10%;">
      <label for="password">Password:</label>
      <input type="password" id="password" placeholder="password" required><br><br>
      </div>
      <button type="submit">Register</button>
    </form>

    <hr>

    <h2>Policy Creation</h2>
    <form id="createPolicyForm" onclick="createPolicy()">
      <div style="width: 10%;">
      <label for="amount">Amount:</label>
      <input type="number" id="amount" name="amount" min="0" required><br><br>
      </div>
      <div style="width: 10%;">
      <label for="policyType">Policy Type:</label>
      <input type="text" id="policyType" name="policyType" required><br><br>
      </div>
      <button type="submit">Create Policy</button>
    </form>

    <hr>

    <h2>Claim Initiation</h2>
    <form id="initiateClaimForm" onclick="initiateClaim()">
      <div style="width: 10%;">
      <label for="policyId">Policy ID:</label>
      <input type="number" id="policyId" name="policyId" min="1" required><br><br>
      </div>
      <div style="width: 40%;">
      <label for="claimReason">Claim Reason:</label>
      <input type="text" id="claimReason" name="claimReason" required><br><br>
      </div>

      <div style="width: 10%;">
      <label for="claimAmount">Claim Amount:</label>
      <input type="number" id="claimAmount" name="claimAmount" min="0" required><br><br>
      </div>
      <button type="submit">Initiate Claim</button>
    </form>

    <hr>

    <h2>Claim Verification</h2>
    <form id="verifyClaimForm" onclick="verifyClaim()">
      <div>
      <label for="claimId">Claim ID:</label>
      <input type="number" id="claimId" name="claimId" min="1" required><br><br>
      </div>
      <button type="submit">Verify Claim</button>
    </form>

    <hr>

    <h2>Output</h2>
    <div id="output"></div>
    <link rel="stylesheet" href="">
    <a href="/chainThat.html"></a>
    </span>
  </body>
</html>
